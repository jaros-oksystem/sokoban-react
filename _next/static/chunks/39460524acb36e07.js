(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,41054,e=>{e.v("/sokoban-react/_next/static/media/logo.536fba4b.svg")},31530,e=>{e.v("/sokoban-react/_next/static/media/wall.bd91bc79.svg")},97287,e=>{e.v("/sokoban-react/_next/static/media/goal.ffa462d1.svg")},95579,e=>{e.v("/sokoban-react/_next/static/media/box.77815d28.svg")},35910,e=>{e.v("/sokoban-react/_next/static/media/player.7e213bae.svg")},93965,e=>{e.v("/sokoban-react/_next/static/media/box_on_goal.b71cdb00.svg")},63584,e=>{e.v("/sokoban-react/_next/static/media/player_on_goal.a3786ba2.svg")},80239,e=>{e.v("/sokoban-react/_next/static/media/error.c0755453.svg")},45163,e=>{e.v("/sokoban-react/_next/static/media/empty_tile.bbfc06e6.svg")},63646,e=>{"use strict";let t="options";function i(){let e=void 0===globalThis.window?null:localStorage.getItem(t);if(null==e)return{grid:!1,textGraphics:!1};let i=JSON.parse(e);return{grid:i.grid??!1,textGraphics:i.textGraphics??!1}}function l(e){localStorage.setItem(t,JSON.stringify(e))}e.s(["getOptionsFromLocalStorage",()=>i,"saveOptionsToLocalStorage",()=>l])},33243,48342,e=>{"use strict";var t,i=((t={})[t.UP=0]="UP",t[t.LEFT=1]="LEFT",t[t.DOWN=2]="DOWN",t[t.RIGHT=3]="RIGHT",t);function l(e){switch(e){case"w":case"ArrowUp":return 0;case"a":case"ArrowLeft":return 1;case"s":case"ArrowDown":return 2;case"d":case"ArrowRight":return 3;default:return null}}function n(e){switch(e){case 0:return 2;case 1:return 3;case 2:return 0;case 3:return 1}}function r(e){switch(e){case 0:return 1;case 1:return 2;case 2:return 3;case 3:return 0}}e.s(["DirectionEnum",()=>i,"getDirectionEnumFromKeyboardEventKey",()=>l,"getOppositeDirection",()=>n,"getRotatedDirection",()=>r],48342);class a{x;y;constructor(e,t){this.x=e,this.y=t}equals(e){return this.x===e.x&&this.y===e.y}getShifted(e,t=1){switch(e){case i.UP:return new a(this.x,this.y-t);case i.DOWN:return new a(this.x,this.y+t);case i.LEFT:return new a(this.x-t,this.y);case i.RIGHT:return new a(this.x+t,this.y)}}getDirectionOfAdjacentObject(e){for(let t of[i.UP,i.DOWN,i.LEFT,i.RIGHT])if(e.equals(this.getShifted(t)))return t;return null}}e.s(["default",()=>a],33243)},10649,e=>{"use strict";var t,i=((t={})[t.EMPTY=0]="EMPTY",t[t.WALL=1]="WALL",t[t.GOAL=2]="GOAL",t[t.BOX=3]="BOX",t[t.PLAYER=4]="PLAYER",t[t.BOX_ON_GOAL=5]="BOX_ON_GOAL",t[t.PLAYER_ON_GOAL=6]="PLAYER_ON_GOAL",t);function l(e){switch(e){case 0:return"Empty";case 1:return"Wall";case 2:return"Goal";case 3:return"Box";case 4:return"Player";case 5:return"Box on goal";case 6:return"Player on goal"}}e.s(["LevelTileEnum",()=>i,"getTileTypeName",()=>l])},3205,99107,68729,21946,18754,18896,27141,26184,62940,e=>{"use strict";var t=e.i(91398);let i=(0,e.i(91788).memo)(function({className:e,content:i}){return(0,t.jsx)("button",{className:e,children:i})},(e,t)=>e.tileType==t.tileType);e.s(["TileButtonMemo",0,i],3205);let l={src:e.i(31530).default,width:512,height:512,blurWidth:0,blurHeight:0};e.s(["default",0,l],99107);let n={src:e.i(97287).default,width:512,height:512,blurWidth:0,blurHeight:0};e.s(["default",0,n],68729);let r={src:e.i(95579).default,width:512,height:512,blurWidth:0,blurHeight:0};e.s(["default",0,r],21946);let a={src:e.i(35910).default,width:512,height:512,blurWidth:0,blurHeight:0};e.s(["default",0,a],18754);let s={src:e.i(93965).default,width:512,height:512,blurWidth:0,blurHeight:0};e.s(["default",0,s],18896);let o={src:e.i(63584).default,width:512,height:512,blurWidth:0,blurHeight:0};e.s(["default",0,o],27141);let u={src:e.i(80239).default,width:36,height:36,blurWidth:0,blurHeight:0};e.s(["default",0,u],26184);let h={src:e.i(45163).default,width:512,height:512,blurWidth:0,blurHeight:0};e.s(["default",0,h],62940)},91426,e=>{"use strict";var t=e.i(91398),i=e.i(33243),l=e.i(91788),n=e.i(26019),r=e.i(3205),a=e.i(99107),s=e.i(68729),o=e.i(21946),u=e.i(18754),h=e.i(18896),c=e.i(27141),d=e.i(26184),f=e.i(62940),g=e.i(63646),x=e.i(10649);function m({level:e,levelState:m,tileOnClickHandler:v=()=>{},verticalSpaceTakenPx:T=100}){let p=(0,g.getOptionsFromLocalStorage)(),A=p.grid,E=p.textGraphics;function b(){return{width:void 0===globalThis.window?0:globalThis.window.innerWidth,height:void 0===globalThis.window?0:globalThis.window.innerHeight}}let[y,L]=(0,l.useState)(b());(0,l.useEffect)(()=>{globalThis.window.addEventListener("resize",()=>L(b()),!1)},[]);let P=Math.max(2,Math.min(80,Math.floor(Math.min((y.width-40)/e.lenX,(y.height-T)/e.lenY))));void 0!==globalThis.document&&(document.documentElement.style.setProperty("--tile-size",P+"px"),document.documentElement.style.setProperty("--tile-font-size",P/1.5+"px"));let O="tile text-2xl "+(A?"border-[1px] border-black ":"");function w(t){let i=t.currentTarget.getBoundingClientRect();v(Math.min(e.lenX-1,Math.floor((t.clientX-i.left)/P)),Math.min(e.lenY-1,Math.floor((t.clientY-i.top)/P)))}return(0,t.jsx)("div",{className:"flex border-1",onMouseDown:w,onMouseOver:e=>1&e.buttons?w(e):{},children:Array.from({length:e.lenX},(l,g)=>(0,t.jsx)("div",{className:"whitespace-nowrap",children:Array.from({length:e.lenY},(l,v)=>{let T={content:E?e.transformTileAtCoordinates(new i.default(g,v),"","■","⸱","ⵔ","ᐳ","ⵙ","ᐷ","☠",m):(0,t.jsx)(n.default,{draggable:"false",loading:"eager",src:e.transformTileAtCoordinates(new i.default(g,v),f.default,a.default,s.default,o.default,u.default,h.default,c.default,d.default,m),alt:"Tile",height:80,width:80}),className:O,tileType:e.transformTileAtCoordinates(new i.default(g,v),x.LevelTileEnum.EMPTY,x.LevelTileEnum.WALL,x.LevelTileEnum.GOAL,x.LevelTileEnum.BOX,x.LevelTileEnum.PLAYER,x.LevelTileEnum.BOX_ON_GOAL,x.LevelTileEnum.PLAYER_ON_GOAL,x.LevelTileEnum.EMPTY,m)};return(0,t.jsx)(r.TileButtonMemo,{...T},"Tile, x:"+g+", y:"+v)})},"Tile row:"+g))})}e.s(["default",()=>m])},11244,58638,53871,12636,39392,e=>{"use strict";var t=e.i(10649);function i(e,t,i){return[...Array(e)].map(()=>Array(t).fill(i))}function l(e,t,l){let n=i(e,t,l(0,0));for(let i=0;i<e;i++)for(let e=0;e<t;e++)n[i][e]=l(i,e);return n}function n(e){return l(e[0].length,e.length,(t,i)=>e[i][t])}function r(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++){if(e[i].length!=t[i].length)return!1;for(let l=0;l<e[0].length;l++)if(e[i][l]!=t[i][l])return!1}return!0}function a(e,t,l=1){if(0==e.length)return i(2*l,2*l,t);let n=i(e.length+2*l,e[0].length+2*l,t);for(let t=0;t<e.length;t++)for(let i=0;i<e[0].length;i++)n[t+l][i+l]=e[t][i];return n}function s(e,t=1){return e.length-2*t<1||e[0].length-2*t<1?[]:l(e.length-2*t,e[0].length-2*t,(i,l)=>e[i+t][l+t])}function o(e){return[...e].reverse().join("")}function u(e,t){let i=[];for(let l=0;l<e.length;l+=t)i.push(e.substring(l,l+t));return i}function h(e){if(e.length<2)return[e];let t=[],i=0;for(let l=0;l<e.length+1;l++)(l==e.length||e.charAt(i)!=e.charAt(l))&&(t.push(e.substring(i,l)),i=l);return t}function c(e){return/^\d*[1-9]\d*$/.test(e)}function d(e,t,i){return e.substring(0,i)+t+e.substring(i+1)}e.s(["enlargeMatrixOnEachSide",()=>a,"getMatrixOfSize",()=>i,"getMatrixWithConditionalFill",()=>l,"getTransposedMatrix",()=>n,"matricesAreEqual",()=>r,"trimMatrixOnEachSide",()=>s],58638),e.s(["chunkString",()=>u,"getStringWithChangedCharAt",()=>d,"isStringAPositiveInteger",()=>c,"reverseString",()=>o,"splitStringToRepeatingGroups",()=>h],53871);let f="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ*.",g=f.length,x=f[0],m=f[g-1];function v(e){if(0==e)return"0";let t="";for(;e>0;)t+=f[e%g],e=Math.floor(e/g);return o(t)}function T(e){let t=0,i=1,l=o(e);for(let n=0;n<l.length;n++){let r=f.indexOf(l[n]);if(-1==r)throw Error("Input is not in base64: "+e+", at: "+e[n]+", "+n);t+=i*r,i*=g}return t}function p(e){let t="",i=u(e,6);for(let e=0;e<i.length;e++)t+=v(Number.parseInt(i[e],2));return t}function A(e){let t="",i="0".repeat(6);for(let l=0;l<e.length;l++)t+=(i+T(e[l]).toString(2)).slice(-i.length);return t}e.s(["BASE64_BITS",0,6,"BASE64_ONES_CHAR",0,x,"BASE64_ZEROS_CHAR",0,m,"base64StringToBinaryString",()=>A,"base64ToDecimal",()=>T,"binaryStringToBase64String",()=>p,"decimalToBase64",()=>v],12636);var E=e.i(33243);function b(e){let t=h(e),i="";for(let e=0;e<t.length;e++){let l=t[e],n=l.startsWith(m)?"(":l.startsWith(x)?")":"";if(l.length>2&&""!=n){let e=v(l.length);i+=n.repeat(e.length)+e}else i+=l}return i}function y(e){let t="";for(let i=0;i<e.length;){let l="("==e[i]?m:")"==e[i]?x:"";if(""==l)t+=e[i++];else{let n=i;for(;"("==e[i]||")"==e[i];)i++;let r=i-n;t+=l.repeat(T(e.substring(i,i+r))),i+=r}}return t}function L(e,t){return new E.default(Math.floor(e/t),e%t)}function P(e,t){return t*e.x+e.y}function O(e){return l(e.length,e[0].length,(t,i)=>!e[t][i])}function w(e){let t=[];for(let i=0;i<e.length;i++)for(let l=0;l<e[0].length;l++)e[i][l]&&t.push(new E.default(i,l));return t}function j(e,t){for(let i=0;i<e.length;i++)for(let l=0;l<e[0].length;l++)if(e[i][l]&&!t[i][l])return!1;return!0}function S(e,t=[]){let i="";for(let l=0;l<e.length;l++)for(let n=0;n<e[0].length;n++)(0==t.length||t[l][n])&&(i+=String(e[l][n]?"1":"0"));return i}function B(e,t,l,n=[]){let r=i(t,l,!1),a=0;for(let i=0;i<t;i++)for(let t=0;t<l;t++)(0==n.length||n[i][t])&&(r[i][t]=1==Number.parseInt(e[a]),a++);return r}function I(e){let t=a(e,!1),i=t.length,n=t[0].length,r=[new E.default(-1,-1),new E.default(0,-1),new E.default(1,-1),new E.default(-1,0),new E.default(1,0),new E.default(-1,1),new E.default(0,1),new E.default(1,1)];return l(i,n,(e,l)=>{if(t[e][l])return!1;let a=!1;for(let s of r){let r=e+s.x,o=l+s.y;if(!(r<0)&&!(o<0)&&!(r>=i)&&!(o>=n)&&t[r][o]){a=!0;break}}return a})}function _(e){let t=N(e),i=N(e.getLevelTransposed());return i.length<t.length?d(i,"_",i.indexOf("-")):t}function N(e){var i,l;let n,a;return v(e.lenX)+"-"+v(e.lenY)+"-"+((i=e).isInitialPlayerAtNoPlayerCoordinates()?"":v(P(i.initialPlayer,i.lenY)))+(n=C(l=e,t.LevelTileEnum.WALL),r(n,I(a=s(l.getPlayableAreaMask())))?"_"+k(a):"-"+k(n))+function(e){let i=C(e,t.LevelTileEnum.GOAL);if(!e.isInitialPlayerAtNoPlayerCoordinates()){let t=e.getPlayableAreaMask();if(j(i,t))return"_"+k(i,t)}return"-"+k(i,M(e))}(e)+function(e){let i=C(e,t.LevelTileEnum.BOX);if(!e.isInitialPlayerAtNoPlayerCoordinates()){let t=e.getViableBoxMask();if(j(i,t))return"_"+k(i,t)}return"-"+k(i,M(e))}(e)}function M(e){return O(C(e,t.LevelTileEnum.WALL))}function C(e,n){switch(n){case t.LevelTileEnum.WALL:case t.LevelTileEnum.GOAL:return l(e.lenX,e.lenY,(t,i)=>e.levelTiles[t][i]==n);case t.LevelTileEnum.BOX:{let t=i(e.lenX,e.lenY,!1);for(let i of e.initialBoxes)t[i.x][i.y]=!0;return t}default:throw Error("Bitmap encoding not supported for tile type: "+n)}}function k(e,t=[]){return b(p(function(e,t){if(0==e.length)return e;let i=e.at(-1);if(void 0===i)throw Error("Could not bit fill a binary string");return e+i.repeat((6-e.length%6)%6)}(S(e,t),6)))}e.s(["ALT_SEPARATOR",0,"_","SEPARATOR",0,"-","binaryStringToBitmap",()=>B,"bitmapToBinaryString",()=>S,"bitmapToCoordinates",()=>w,"canMaskBeUsedOnBitmap",()=>j,"compressBase64String",()=>b,"coordinatesToTileId",()=>P,"decompressBase64String",()=>y,"getInvertedBitmap",()=>O,"tileIdToCoordinates",()=>L,"trimmedPlayableMaskToWallBitmap",()=>I],39392),e.s(["default",()=>_],11244)},41941,e=>{"use strict";var t=e.i(91398);function i({text:e,onClick:i}){return(0,t.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",onClick:i,children:e})}e.s(["default",()=>i])},48796,35125,72758,e=>{"use strict";e.s(["NO_PLAYER_COORDINATES",()=>a,"default",()=>s],35125);var t=e.i(10649),i=e.i(33243),l=e.i(58638),n=e.i(48342);class r{parentLevel;player;boxes;turn;constructor(e,t,i,l){this.parentLevel=e,this.player=t,this.boxes=i,this.turn=l}isPlayerAt(e){return this.player.equals(e)}getBoxIdxAt(e){let t=this.boxes.findIndex(t=>t.equals(e));return -1==t?null:t}isWon(){return this.boxes.length>0&&this.boxes.every(e=>this.parentLevel.isGoalAt(e))}isPlayerAtNoPlayerCoordinates(){return a.equals(this.player)}createNewLevelStateForPlayerMove(e){if(this.isWon())return null;let t=this.player.getShifted(e);if(!this.parentLevel.isValidPlaceForObjectAt(t))return null;let i=this.getBoxIdxAt(t);if(null!=i){let l=t.getShifted(e);if(!this.canBoxBePushedTo(l))return null;this.boxes[i]=l}return new r(this.parentLevel,t,this.boxes,this.turn+1)}createNewLevelStateForClick(e){if(this.isWon()||this.isPlayerAtNoPlayerCoordinates()||this.player.equals(e)||this.parentLevel.isWallAt(e))return null;let t=this.getBoxIdxAt(e);if(null!=t){let i=this.player.getDirectionOfAdjacentObject(e);if(null==i)return null;{let l=e.getShifted(i);return this.canBoxBePushedTo(l)?(this.boxes[t]=l,new r(this.parentLevel,e,this.boxes,this.turn+1)):null}}let i=function(e,t,i,r,a){let s=(0,l.getMatrixOfSize)(e,t,!1),o=[i],u=[];s[i.x][i.y]=!0;let h=0;for(;o.length>0;){for(;o.length>0;){let e=o.pop();if(void 0===e)throw Error("Nothing to pop");if(r.equals(e))return h;for(let t of[n.DirectionEnum.UP,n.DirectionEnum.LEFT,n.DirectionEnum.DOWN,n.DirectionEnum.RIGHT]){let i=e.getShifted(t);a(i)||s[i.x][i.y]||(s[i.x][i.y]=!0,u.push(i))}}o=u,u=[],h++}return null}(this.parentLevel.lenX,this.parentLevel.lenY,this.player,e,e=>!this.parentLevel.isValidPlaceForObjectAt(e)||null!=this.getBoxIdxAt(e));return null==i?null:new r(this.parentLevel,e,this.boxes,this.turn+i)}canBoxBePushedTo(e){return this.parentLevel.isValidPlaceForObjectAt(e)&&null==this.getBoxIdxAt(e)}}let a=new i.default(-1,-1);class s{lenX;lenY;levelTiles;initialBoxes;initialPlayer;constructor(e,t,i,l,n){this.lenX=e,this.lenY=t,this.levelTiles=i,this.initialPlayer=n,this.initialBoxes=l}getInitialLevelState(){return new r(this,this.initialPlayer,this.initialBoxes.slice(),0)}getTileAt(e){return this.levelTiles[e.x][e.y]}isInitialPlayerAt(e){return this.initialPlayer.equals(e)}isWallAt(e){return this.getTileAt(e)==t.LevelTileEnum.WALL}isGoalAt(e){return this.getTileAt(e)==t.LevelTileEnum.GOAL}isEmptyTileAt(e){return this.getTileAt(e)==t.LevelTileEnum.EMPTY}isInitiallyEmptyAt(e){return this.isEmptyTileAt(e)&&!this.isInitialPlayerAt(e)&&null==this.getInitialBoxIdxAt(e)}getInitialBoxIdxAt(e){let t=this.initialBoxes.findIndex(t=>t.equals(e));return -1==t?null:t}isValidPlaceForObjectAt(e){return e.x>=0&&e.y>=0&&e.x<this.lenX&&e.y<this.lenY&&!this.isWallAt(e)}isInitialPlayerAtNoPlayerCoordinates(){return a.equals(this.initialPlayer)}isCornerAt(e){if(!this.isValidPlaceForObjectAt(e))return!1;let t=!this.isValidPlaceForObjectAt(e.getShifted(n.DirectionEnum.UP)),i=!this.isValidPlaceForObjectAt(e.getShifted(n.DirectionEnum.LEFT)),l=!this.isValidPlaceForObjectAt(e.getShifted(n.DirectionEnum.DOWN)),r=!this.isValidPlaceForObjectAt(e.getShifted(n.DirectionEnum.RIGHT));return t&&i||i&&l||l&&r||r&&t}canBoxBePushedInDirectionAt(e,t){let i=e.getShifted((0,n.getOppositeDirection)(t)),l=e.getShifted(t);return this.isValidPlaceForObjectAt(l)&&this.isValidPlaceForObjectAt(i)}getLevelCopy(){return new s(this.lenX,this.lenY,this.levelTiles,this.initialBoxes,this.initialPlayer)}changeTileTo(e,t){this.levelTiles[e.x][e.y]=t}removeInitialBoxAt(e){this.initialBoxes=this.initialBoxes.filter(t=>!t.equals(e))}addInitialBoxAt(e){this.initialBoxes.push(e)}moveInitialPlayerTo(e){this.initialPlayer=e}changeLevelBasedOnBrushClick(e,i){let l=this.isInitiallyEmptyAt(e),n=this.isEmptyTileAt(e),r=this.isWallAt(e),s=this.isGoalAt(e),o=null!=this.getInitialBoxIdxAt(e),u=this.isInitialPlayerAt(e);switch(i){case t.LevelTileEnum.EMPTY:if(l)return;(r||s)&&this.changeTileTo(e,t.LevelTileEnum.EMPTY),o&&this.removeInitialBoxAt(e),u&&this.moveInitialPlayerTo(a);break;case t.LevelTileEnum.WALL:if(r)return;(n||s)&&this.changeTileTo(e,t.LevelTileEnum.WALL),o&&this.removeInitialBoxAt(e),u&&this.moveInitialPlayerTo(a);break;case t.LevelTileEnum.GOAL:if(s)return;(n||r)&&this.changeTileTo(e,t.LevelTileEnum.GOAL);break;case t.LevelTileEnum.BOX:if(o)return;r&&this.changeTileTo(e,t.LevelTileEnum.EMPTY),u&&this.moveInitialPlayerTo(a),this.addInitialBoxAt(e);break;case t.LevelTileEnum.PLAYER:if(u)return;r&&this.changeTileTo(e,t.LevelTileEnum.EMPTY),o&&this.removeInitialBoxAt(e),this.moveInitialPlayerTo(e);break;default:throw Error("Tile change not supported for enum: "+i)}}changeLevelDimensions(e,i){let n=(0,l.getMatrixOfSize)(e,i,t.LevelTileEnum.EMPTY);for(let t=0;t<Math.min(e,this.lenX);t++)for(let e=0;e<Math.min(i,this.lenY);e++)n[t][e]=this.levelTiles[t][e];this.levelTiles=n,this.initialBoxes=this.initialBoxes.filter(t=>t.x<e&&t.y<i),(this.initialPlayer.x>=e||this.initialPlayer.y>=i)&&this.moveInitialPlayerTo(a),this.lenX=e,this.lenY=i}getLevelTransposed(){return new s(this.lenY,this.lenX,(0,l.getTransposedMatrix)(this.levelTiles),this.initialBoxes.map(e=>new i.default(e.y,e.x)),new i.default(this.initialPlayer.y,this.initialPlayer.x))}getPlayableAreaMask(){return this.isInitialPlayerAtNoPlayerCoordinates()?(0,l.getMatrixOfSize)(this.lenX,this.lenY,!0):function(e,t,i,r){let a=(0,l.getMatrixOfSize)(e,t,!1),s=[i];for(a[i.x][i.y]=!0;s.length>0;){let e=s.pop();if(void 0===e)throw Error("Nothing to pop");for(let t of[n.DirectionEnum.UP,n.DirectionEnum.LEFT,n.DirectionEnum.DOWN,n.DirectionEnum.RIGHT]){let i=e.getShifted(t);r(i)||a[i.x][i.y]||(a[i.x][i.y]=!0,s.push(i))}}return a}(this.lenX,this.lenY,this.initialPlayer,e=>!this.isValidPlaceForObjectAt(e))}getAllCornersInMask(e){let t=[];for(let l=0;l<this.lenX;l++)for(let n=0;n<this.lenY;n++){if(!e[l][n])continue;let r=new i.default(l,n);this.isCornerAt(r)&&t.push(r)}return t}getViableBoxMask(){let e=this.getPlayableAreaMask();for(let t of this.getAllCornersInMask(e))for(let i of(e[t.x][t.y]=!1,[n.DirectionEnum.RIGHT,n.DirectionEnum.DOWN]))if(this.isValidPlaceForObjectAt(t.getShifted(i))){let l=[],r=t;for(;!this.isGoalAt(r);){if(l.length>0&&this.isCornerAt(r)){for(let t of l)e[t.x][t.y]=!1;break}let t=r.getShifted(i);if(this.canBoxBePushedInDirectionAt(t,(0,n.getRotatedDirection)(i)))break;l.push(r),r=t}}return e}transformTileAtCoordinates(e,t,i,l,n,r,a,s,o,u){let h=this.isEmptyTileAt(e),c=this.isWallAt(e),d=this.isGoalAt(e),f=u?null!=u.getBoxIdxAt(e):null!=this.getInitialBoxIdxAt(e),g=u?u.isPlayerAt(e):this.isInitialPlayerAt(e);if(c&&g||c&&f||f&&g)return o;if(c)return i;if(d&&f)return a;if(d&&g)return s;if(d)return l;else if(f)return n;else if(g)return r;else if(h)return t;else return o}}var o=e.i(12636),u=e.i(39392);let h="Invalid code";function c(e){let t=e.replaceAll(u.ALT_SEPARATOR,u.SEPARATOR).split(u.SEPARATOR);if(6!=t.length)throw Error(h);let n=e.split("").filter(e=>e==u.ALT_SEPARATOR||e==u.SEPARATOR).map(e=>e==u.ALT_SEPARATOR).reduce((e,t)=>[...e,t],[]);try{let e=(0,o.base64ToDecimal)(t[0]),r=(0,o.base64ToDecimal)(t[1]),a=0==t[2].length?new i.default(-1,-1):(0,u.tileIdToCoordinates)((0,o.base64ToDecimal)(t[2]),r),h=n[2]?(0,u.trimmedPlayableMaskToWallBitmap)(d(t[3],e-2,r-2)):d(t[3],e,r),c=new s(e,r,f(h,(0,l.getMatrixOfSize)(e,r,!1)),[],a),g=(0,u.getInvertedBitmap)(h),x=d(t[4],e,r,n[3]?c.getPlayableAreaMask():g);c.levelTiles=f(h,x);let m=d(t[5],e,r,n[4]?c.getViableBoxMask():g);if(c.initialBoxes=(0,u.bitmapToCoordinates)(m),n[0])return c.getLevelTransposed();return c}catch{throw Error(h)}}function d(e,t,i,l=[]){let n=(0,o.base64StringToBinaryString)((0,u.decompressBase64String)(e));return(0,u.binaryStringToBitmap)(n,t,i,l)}function f(e,i){return(0,l.getMatrixWithConditionalFill)(e.length,e[0].length,(l,n)=>e[l][n]?t.LevelTileEnum.WALL:i[l][n]?t.LevelTileEnum.GOAL:t.LevelTileEnum.EMPTY)}e.s(["default",()=>c],48796);let g=`    #####
    #   #
    #$  #
  ###  $##
  #  $ $ #
### # ## #   ######
#   # ## #####  ..#
# $  $          ..#
##### ### #@##  ..#
    #     #########
    #######
`;e.s(["DEFAULT_LEVEL_CODE_EDITOR",0,"8-7-v_7(4_0a0E0_2G","DEFAULT_LEVEL_CODE_GAME",0,"j-b-21_1wc7wA..BYEZ0U40M40we1Me1M_)8f._gkwo)3","DEFAULT_LEVEL_CODE_GAME_XSB",0,g],72758)},3828,(e,t,i)=>{t.exports=e.r(26990)},17139,e=>{"use strict";var t=e.i(91398),i=e.i(91788),l=e.i(33243),n=e.i(10649),r=e.i(91426),a=e.i(11244),s=e.i(53871);function o(){return(0,t.jsx)("div",{className:"border-t border-1"})}var u=e.i(41941);function h({buttonText:e,title:i,content:l,isOpen:n,setIsOpen:r,onOpen:a=()=>{}}){function s(e){e&&a(),r(e)}return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.default,{onClick:()=>s(!0),text:e}),n&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{"aria-hidden":!0,className:"fixed top-0 left-0 w-screen h-screen bg-black/40",onClick:()=>s(!1)}),(0,t.jsxs)("div",{className:"absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 flex flex-col bg-white rounded",children:[(0,t.jsxs)("div",{className:"bg-blue-200 rounded-t",children:[(0,t.jsx)("button",{className:"float-right px-2.5 m-2 pt-1 pb-2 text-xl rounded hover:bg-blue-300",onClick:()=>s(!1),children:"╳"}),(0,t.jsx)("p",{className:"float-left m-3.5 text-xl",children:i})]}),(0,t.jsx)("div",{className:"p-4",children:l})]})]})]})}var c=e.i(48796),d=e.i(35125),f=e.i(58638),g=e.i(72758);function x({value:e,readOnly:i=!1,onChange:l=()=>{}}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"mt-2",children:"Level code:"}),(0,t.jsx)("textarea",{readOnly:i,value:e,placeholder:g.DEFAULT_LEVEL_CODE_GAME,onChange:l,className:"my-2 outline resize-none w-[500] h-24 read-only:bg-gray-200"}),(0,t.jsx)("br",{})]})}function m({value:e,readOnly:i=!1,onChange:l=()=>{}}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:"mt-2",children:"XSB code:"}),(0,t.jsx)("textarea",{readOnly:i,value:e,placeholder:g.DEFAULT_LEVEL_CODE_GAME_XSB,onChange:l,className:"my-2 outline resize-none w-[500] h-96 font-mono read-only:bg-gray-200"}),(0,t.jsx)("br",{})]})}function v({onImport:e}){let[r,a]=(0,i.useState)(""),[s,o]=(0,i.useState)(""),[g,v]=(0,i.useState)(!1),T="⇩ Import";return(0,t.jsx)(h,{onOpen:function(){a(""),o("")},isOpen:g,setIsOpen:v,buttonText:T,title:"Import level",content:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x,{value:r,readOnly:!1,onChange:e=>a(e.target.value)}),(0,t.jsx)(u.default,{text:T,onClick:function(){try{let t=(0,c.default)(r);e(t),v(!1)}catch{alert("Invalid level code")}}}),(0,t.jsx)("div",{className:"my-4"}),(0,t.jsx)(m,{value:s,readOnly:!1,onChange:e=>o(e.target.value)}),(0,t.jsx)(u.default,{text:T,onClick:function(){try{let t=function(e){let t,i=(t=e.split("\n"),{lenX:Math.max(...t.map(e=>e.length)),lenY:t.length}),r=e.split("\n"),a=new l.default(-1,-1),s=[],o=(0,f.getMatrixOfSize)(i.lenX,i.lenY,n.LevelTileEnum.EMPTY);for(let e=0;e<r.length;e++)for(let t=0;t<r[e].length;t++)switch(r[e].charAt(t)){case"@":a=new l.default(t,e);break;case"+":a=new l.default(t,e),o[t][e]=n.LevelTileEnum.GOAL;break;case".":o[t][e]=n.LevelTileEnum.GOAL;break;case"#":o[t][e]=n.LevelTileEnum.WALL;break;case"$":s.push(new l.default(t,e));break;case"*":o[t][e]=n.LevelTileEnum.GOAL,s.push(new l.default(t,e));break;case" ":break;default:throw Error("Error parsing XSB code - unknown character")}return new d.default(i.lenX,i.lenY,o,s,a)}(s);e(t),v(!1)}catch{alert("Invalid XSB code")}}})]})})}let T="\ud83d\udccb";function p({textToCopy:e,text:l=T+" Copy to clipboard"}){let[n,r]=(0,i.useState)(l);return(0,t.jsx)(u.default,{text:n,onClick:function(){navigator.clipboard.writeText(e),r(T+" Copied!"),setTimeout(()=>r(l),2e3)}})}function A({level:e}){let[n,r]=(0,i.useState)(!1),[s,o]=(0,i.useState)(""),[u,c]=(0,i.useState)("");return(0,t.jsx)(h,{onOpen:function(){o((0,a.default)(e)),c((0,f.getMatrixWithConditionalFill)(e.lenY,e.lenX,(t,i)=>e.transformTileAtCoordinates(new l.default(i,t)," ","#",".","$","@","*","+","E")).map(e=>e.join("").trimEnd()).join("\n"))},isOpen:n,setIsOpen:r,buttonText:"⇧ Export",title:"Export level",content:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x,{value:s,readOnly:!0}),(0,t.jsx)(p,{textToCopy:s}),(0,t.jsx)("div",{className:"my-4"}),(0,t.jsx)(m,{value:u,readOnly:!0}),(0,t.jsx)(p,{textToCopy:u})]})})}var E=e.i(41158),b=e.i(59196),y=e.i(48342);function L({initialLevel:e}){let[h,c]=(0,i.useState)(e),[d,f]=(0,i.useState)(n.LevelTileEnum.WALL),[g,x]=(0,i.useState)(h.lenX+""),[m,T]=(0,i.useState)(h.lenY+""),p=[n.LevelTileEnum.EMPTY,n.LevelTileEnum.WALL,n.LevelTileEnum.GOAL,n.LevelTileEnum.BOX,n.LevelTileEnum.PLAYER];return(0,i.useEffect)(()=>{function e(e){let t=(0,y.getDirectionEnumFromKeyboardEventKey)(e.key);if(null!=t){let e=t==y.DirectionEnum.UP?-1:+(t==y.DirectionEnum.DOWN);f(Math.max(0,Math.min(p.length-1,p.indexOf(d)+e)))}}return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex flex-row border-black border-2 w-106 p-2 mx-auto rounded-[10] bg-gray-100",children:[(0,t.jsxs)("div",{className:"pl-2 w-28",children:[(0,t.jsx)("p",{className:"text-xl",children:"Tile brush:"}),p.map(e=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{children:[(0,t.jsx)("input",{type:"radio",name:"brushRadio",value:e,checked:d==e,onChange:()=>f(e)})," ",(0,n.getTileTypeName)(Number(e))]}),(0,t.jsx)("br",{})]},"Brush radio div for enum: "+e))]}),(0,t.jsx)(o,{}),(0,t.jsxs)("div",{className:"w-40 px-4",children:[(0,t.jsx)("p",{className:"text-xl",children:"Set level size:"}),(0,t.jsxs)("div",{className:"mt-2 grid grid-cols-3 gap-3",children:[(0,t.jsx)("p",{children:"Width:"}),(0,t.jsx)("input",{type:"text",value:g,minLength:1,maxLength:3,className:"outline resize-none h-6 ml-3 bg-white w-8 pl-[2px]",onChange:e=>x(e.target.value)}),(0,t.jsx)("br",{}),(0,t.jsx)("p",{children:"Height:"}),(0,t.jsx)("input",{type:"text",value:m,minLength:1,maxLength:3,className:"outline resize-none h-6 ml-3 bg-white w-8 pl-[2px]",onChange:e=>T(e.target.value)}),(0,t.jsx)("br",{}),(0,t.jsx)("div",{className:"col-span-3",children:(0,t.jsx)(u.default,{text:"Set level size",onClick:()=>(function(){if((0,s.isStringAPositiveInteger)(g)&&(0,s.isStringAPositiveInteger)(m)){let e=Number.parseInt(g),t=Number.parseInt(m);if(e>500||t>500)return void alert("Maximum allowed width and height is 500");h.changeLevelDimensions(e,t),c(h.getLevelCopy())}else alert("Both values must be positive integers")})()})})]})]}),(0,t.jsx)(o,{}),(0,t.jsxs)("div",{className:"pl-4 pt-1 flex flex-col justify-center",children:[(0,t.jsx)(A,{level:h}),(0,t.jsx)("div",{className:"my-1"}),(0,t.jsx)(v,{onImport:e=>(function(e){try{c(e),x(e.lenX+""),T(e.lenY+"")}catch{alert("Invalid level code.")}})(e)}),(0,t.jsx)("div",{className:"my-2"}),(0,t.jsx)(E.default,{className:"pl-2",href:{pathname:b.GAME_PAGE_PATH,query:{level:(0,a.default)(h)}},children:(0,t.jsx)(u.default,{text:"⯈ Play"})})]})]}),(0,t.jsx)("div",{className:"my-4 flex justify-center",children:(0,t.jsx)(r.default,{level:h,tileOnClickHandler:function(e,t){h.changeLevelBasedOnBrushClick(new l.default(e,t),d),c(h.getLevelCopy())},verticalSpaceTakenPx:250})})]})}var P=e.i(11205),O=e.i(3828);function w(){let[e,l]=(0,i.useState)(null),n=(0,O.useRouter)();return(0,i.useEffect)(()=>{if(!n.isReady)return;let e=n.query.level;if(e?.constructor===String)try{l((0,c.default)(e));return}catch{}l((0,c.default)(g.DEFAULT_LEVEL_CODE_EDITOR))},[n.isReady,n.query.level]),(0,t.jsxs)("div",{children:[(0,t.jsx)(P.default,{activatePage:P.PagesEnum.EDITOR}),(0,t.jsx)("div",{className:"mt-4",children:null!=e&&(0,t.jsx)(L,{initialLevel:e})})]})}e.s(["default",()=>w],17139)},33726,(e,t,i)=>{let l="/editor";(window.__NEXT_P=window.__NEXT_P||[]).push([l,()=>e.r(17139)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push([l])})},48761,e=>{e.v(t=>Promise.all(["static/chunks/f4fe8aeb8343dcd3.js"].map(t=>e.l(t))).then(()=>t(93594)))},28805,e=>{e.v(t=>Promise.all(["static/chunks/3dcc93bb4829c1ba.js"].map(t=>e.l(t))).then(()=>t(79466)))}]);